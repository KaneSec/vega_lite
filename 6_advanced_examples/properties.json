{
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "title": "Number of Military Personel",
    "width": 800,
    "height": 700,
    "projection": {
        "type": "equirectangular",
        "center": [145, -37.8],
        "scale": {"expr": "zoom_level"}
    },
    "params": [
    {
        "name": "Year_selection",
        "value": 2018,
        "bind": {"input": "range", "min": 2010, "max": 2020, "step": 1}
        },
        {
            "name": "zoom_level", "value": 30000,
            "bind": {"input": "range", "min": 5000, "max": 50000, "step": 100, "name": "Zoom level"} 
        }
    ],
    "layer":[
        {
            "data": {
                "url": "https://raw.githubusercontent.com/KaneSec/vega_lite/main/6_advanced_examples/data/VIC_LOCALITY_POLYGON_SHP.json",
                "format": {"type": "topojson", "feature": "VIC_LOCALITY_POLYGON_SHP"}
            },
            "transform": [
                {"calculate": "'Data is not available in ' + datum.properties.NAME", "as": "note"}
            ],
            "mark": {"type": "geoshape", "fill": "#ddd", "stroke": "white", "strokeWidth":1},
            "encoding": {
                "tooltip": {
                "field": "note"
                }
            }
        },
        {
        "data": {
            "url": "https://raw.githubusercontent.com/KaneSec/vega_lite/main/6_advanced_examples/data/house_price_by_suburb_long_format.csv"
        },
        "transform": [
            {
            "lookup": "locality",
            "from": {
                "data": {
                "url": "https://raw.githubusercontent.com/KaneSec/vega_lite/main/6_advanced_examples/data/VIC_LOCALITY_POLYGON_SHP.json",
                "format": {"type": "topojson", "feature": "VIC_LOCALITY_POLYGON_SHP"}
                },
                "key": "properties.NAME"
            },
            "as": "geo"
            },
            {"filter": "datum.year == Year_selection"}
        ],
        "mark": {"type": "geoshape", "stroke": "#fff", "strokeWidth":0.5},
        "encoding": {
            "shape": {
                "field": "geo",
                "type": "geojson"
            },
            "color": {
                "field": "price", 
                "type": "quantitative",
                "scale":{
                    "type": "threshold",
                    "domain": [400000, 500000, 600000, 700000, 800000, 900000, 1000000,  1100000, 1200000, 1300000, 1400000, 1500000],
                    "scheme": "reds"
                },
                "legend": {"format": ","}
                
            },
            "tooltip": [
            {"field": "locality", "type": "nominal", "title": "Suburb"},
            {"field": "price", "type": "quantitative", "title": "Median Price", "format":","},
            {"field": "year", "type": "quantitative", "title": "Year"}
            ]
        }
      }
    ],

  
    "config": {}
}